from datetime import datetime
from abc import abstractmethod
from time import sleep
from typing import Sequence

import requests

from earnmi.core.Context import Context
from earnmi.data.BarDriver import BarDriver, DayRange
from earnmi.data.BarStorage import BarStorage
from earnmi.model.bar import LatestBar, BarData
from vnpy.trader.constant import Interval


class SW2Driver(BarDriver):
    """
    申万二级指数行情。
    """
    INDEX_SYMBOL = '000001.XSHG'
    NAME:str = '申万二级指数'
    DESCRIPTION:str = '申万二级指数行情，数据来源于立得行情，86个行业，3880个股'

    def __init__(self):
        self.symbol_name_map = {}  ##各行业指数代码和中文名称
        self.symobl_sub_list_map = {} ##各行业指数代码的成分股票
        map = self.symbol_name_map
        map['801744'] = '船舶制造II'
        map['801742'] = '航空装备II'
        map['801743'] = '地面兵装II'
        map['801741'] = '航天装备II'
        map['801024'] = '采掘服务II'
        map['801023'] = '石油开采II'
        map['801022'] = '其他采掘II'
        map['801021'] = '煤炭开采II'
        map['801112'] = '视听器材II'
        map['801111'] = '白色家电II'
        map['801724'] = '专业工程II'
        map['801205'] = '商业物业经营II'
        map['801204'] = '专业零售II'
        map['801203'] = '一般零售II'
        map['801202'] = '贸易II'
        map['801164'] = '水务II'
        map['801162'] = '环保工程及服务II'
        map['801163'] = '燃气II'
        map['801161'] = '电力II'
        map['801722'] = '装修装饰II'
        map['801723'] = '基础建设II'
        map['801016'] = '种植业II'
        map['801017'] = '畜禽养殖II'
        map['801014'] = '饲料II'
        map['801015'] = '渔业II'
        map['801013'] = '农业综合II'
        map['801011'] = '林业II'
        map['801018'] = '动物保健II'
        map['801123'] = '饮料制造II'
        map['801124'] = '食品加工II'
        map['801751'] = '营销传播II'
        map['801752'] = '互联网传媒II'
        map['801053'] = '黄金II'
        map['801051'] = '金属非金属新材料II'
        map['801054'] = '稀有金属II'
        map['801055'] = '工业金属II'
        map['801178'] = '物流II'
        map['801175'] = '高速公路II'
        map['801174'] = '机场II'
        map['801177'] = '铁路运输II'
        map['801176'] = '航运II'
        map['801171'] = '港口II'
        map['801173'] = '航空运输II'
        map['801172'] = '公交II'
        map['801094'] = '汽车整车II'
        map['801092'] = '汽车服务II'
        map['801711'] = '水泥制造II'
        map['801713'] = '其他建材II'
        map['801712'] = '玻璃制造II'
        map['801093'] = '汽车零部件II'
        map['801131'] = '纺织制造II'
        map['801132'] = '服装家纺II'
        map['801181'] = '房地产开发II'
        map['801182'] = '园区开发II'
        map['801223'] = '通信运营II'
        map['801222'] = '计算机应用II'
        map['801761'] = '文化传媒II'
        map['801041'] = '钢铁II'
        map['801881'] = '其他交运设备II'
        map['801231'] = '综合II'
        map['801141'] = '包装印刷II'
        map['801142'] = '家用轻工II'
        map['801143'] = '造纸II'
        map['801725'] = '园林工程II'
        map['801721'] = '房屋建设II'
        map['801085'] = '电子制造II'
        map['801084'] = '光学光电子II'
        map['801081'] = '半导体II'
        map['801083'] = '元件II'
        map['801082'] = '其他电子II'
        map['801032'] = '化学纤维II'
        map['801033'] = '化学原料II'
        map['801034'] = '化学制品II'
        map['801035'] = '石油化工II'
        map['801036'] = '塑料II'
        map['801037'] = '橡胶II'
        map['801101'] = '计算机设备II'
        map['801102'] = '通信设备II'
        map['801733'] = '电源设备II'
        map['801731'] = '电机II'
        map['801193'] = '证券II'
        map['801192'] = '银行II'
        map['801191'] = '多元金融II'
        map['801194'] = '保险II'
        map['801211'] = '餐饮II'
        map['801212'] = '景点II'
        map['801213'] = '酒店II'
        map['801214'] = '旅游综合II'
        map['801074'] = '专用设备II'
        map['801075'] = '金属制品II'
        map['801076'] = '运输设备II'
        map['801072'] = '通用机械II'
        map['801073'] = '仪器仪表II'
        map['801156'] = '医疗服务II'
        map['801155'] = '中药II'
        map['801154'] = '医药商业II'
        map['801153'] = '医疗器械II'
        map['801152'] = '生物制品II'
        map['801151'] = '化学制药II'
        map['801732'] = '电气自动化设备II'
        map['801734'] = '高低压设备II'
        stockMap = self.symobl_sub_list_map
        stockMap['801011'] = ['000592', '002679', '600265']
        stockMap['801012'] = ['000505', '000911', '000930', '000972', '002286', '002852', '300138', '300175', '300268',
                              '300829', '600127', '600191', '600251', '600298', '600737', '600873', '600962']
        stockMap['801013'] = ['300021']
        stockMap['801014'] = ['000048', '000702', '000876', '002100', '002124', '002157', '002311', '002385', '002548',
                              '002567', '002891', '300673', '603363', '603609', '603668']
        stockMap['801015'] = ['000798', '002069', '002086', '002696', '300094', '600097', '600257', '600275', '600467']
        stockMap['801016'] = ['000713', '000998', '002041', '002772', '300087', '300189', '300511', '600108', '600313',
                              '600354', '600359', '600371', '600506', '600540', '600598', '601118', '601952', '603336']
        stockMap['801017'] = ['000735', '002234', '002299', '002321', '002458', '002714', '002746', '002982', '300106',
                              '300313', '300498', '300761', '600975']
        stockMap['801018'] = ['002688', '002868', '300119', '300871', '600195', '600201', '603566', '603718', '603739',
                              '688098', '688526']
        stockMap['801021'] = ['000552', '000571', '000723', '000780', '000937', '000968', '000983', '002128', '600121',
                              '600123', '600157', '600188', '600348', '600395', '600397', '600403', '600408', '600508',
                              '600546', '600725', '600740', '600758', '600792', '600971', '600985', '600989', '600997',
                              '601001', '601011', '601015', '601088', '601101', '601225', '601666', '601699', '601898',
                              '601918', '603113']
        stockMap['801022'] = ['000629', '000655', '000762', '000833', '000923', '002978', '600295', '600532', '601969',
                              '603505']
        stockMap['801023'] = ['600759', '600777', '601857']
        stockMap['801024'] = ['002207', '002554', '002629', '002828', '300157', '300164', '300191', '600339', '600583',
                              '600871', '600968', '601808', '603619', '603727', '603979']
        stockMap['801032'] = ['000301', '000420', '000677', '000703', '000782', '000936', '000949', '002064', '002172',
                              '002206', '002254', '002427', '002493', '300699', '300777', '300876', '600063', '600346',
                              '600527', '600810', '600889', '601233', '603225', '603332', '605166']
        stockMap['801033'] = ['000422', '000510', '000545', '000635', '000683', '000707', '000818', '000822', '002002',
                              '002053', '002092', '002125', '002386', '002648', '002805', '300285', '300409', '300655',
                              '600075', '600091', '600277', '600319', '600328', '600367', '600409', '600618', '600714',
                              '600722', '600929', '601216', '601678', '603067', '603077', '603299', '603928', '603938',
                              '688268']
        stockMap['801034'] = ['000408', '000523', '000525', '000553', '000565', '000731', '000737', '000830', '000881',
                              '000893', '000902', '000912', '000953', '000985', '000990', '002004', '002037', '002054',
                              '002080', '002094', '002096', '002109', '002136', '002145', '002165', '002170', '002201',
                              '002211', '002215', '002226', '002246', '002250', '002258', '002274', '002319', '002326',
                              '002341', '002360', '002361', '002391', '002407', '002408', '002440', '002453', '002455',
                              '002470', '002476', '002496', '002497', '002513', '002538', '002539', '002545', '002549',
                              '002556', '002562', '002584', '002588', '002597', '002601', '002632', '002637', '002643',
                              '002666', '002669', '002683', '002709', '002734', '002741', '002748', '002749', '002783',
                              '002802', '002809', '002810', '002812', '002827', '002895', '002909', '002915', '002917',
                              '002919', '002942', '002971', '002999', '300019', '300035', '300037', '300041', '300054',
                              '300067', '300072', '300073', '300082', '300107', '300109', '300132', '300163', '300169',
                              '300174', '300196', '300200', '300214', '300225', '300236', '300243', '300261', '300387',
                              '300398', '300405', '300429', '300437', '300446', '300481', '300487', '300505', '300522',
                              '300530', '300535', '300537', '300568', '300575', '300576', '300596', '300610', '300637',
                              '300641', '300665', '300690', '300721', '300727', '300740', '300743', '300758', '300769',
                              '300796', '300798', '300801', '300806', '300821', '300847', '300848', '300856', '600078',
                              '600096', '600141', '600160', '600165', '600176', '600228', '600230', '600249', '600273',
                              '600299', '600309', '600315', '600352', '600378', '600389', '600423', '600426', '600458',
                              '600470', '600486', '600500', '600589', '600596', '600623', '600691', '600727', '600731',
                              '600746', '600844', '603002', '603010', '603026', '603041', '603078', '603086', '603110',
                              '603133', '603155', '603181', '603188', '603192', '603217', '603227', '603256', '603330',
                              '603360', '603378', '603379', '603585', '603599', '603601', '603605', '603630', '603639',
                              '603650', '603681', '603683', '603722', '603725', '603737', '603790', '603810', '603822',
                              '603823', '603867', '603879', '603916', '603948', '603949', '603968', '603970', '603977',
                              '603980', '603983', '605006', '605366', '605399', '688005', '688021', '688065', '688106',
                              '688116', '688157', '688196', '688199', '688268', '688398', '688550', '688585']
        stockMap['801035'] = ['000059', '000096', '000159', '000554', '000637', '000698', '000819', '002221', '002778',
                              '002986', '300135', '300839', '600028', '600256', '600387', '600688', '603353', '603798',
                              '603906']
        stockMap['801036'] = ['000859', '000973', '002108', '002263', '002324', '002395', '002768', '002825', '002838',
                              '002886', '300180', '300218', '300221', '300230', '300305', '300321', '300325', '300478',
                              '300538', '300539', '300586', '300644', '300716', '300717', '600143', '601208', '603266',
                              '603580', '603615', '603991', '605008', '688026', '688299']
        stockMap['801037'] = ['000589', '000599', '002068', '002224', '002381', '002442', '002753', '300121', '300320',
                              '300587', '300731', '300767', '600182', '600469', '601058', '601163', '601500', '601966',
                              '603033']
        stockMap['801041'] = ['000708', '000709', '000717', '000761', '000778', '000825', '000898', '000932', '000959',
                              '002075', '002110', '002318', '002443', '002478', '002756', '300881', '600010', '600019',
                              '600022', '600117', '600126', '600231', '600282', '600307', '600399', '600507', '600569',
                              '600581', '600782', '600808', '601003', '601005', '603878', '603995', '688186']
        stockMap['801051'] = ['000633', '000795', '000962', '000969', '000970', '002056', '002057', '002130', '002182',
                              '002340', '300127', '300224', '300395', '300489', '300748', '300811', '300835', '300855',
                              '600114', '600206', '600330', '600366', '600516', '600615', '600980', '603045', '603260',
                              '603612', '603688', '603826', '603978', '688077', '688116', '688122', '688300', '688357',
                              '688598']
        stockMap['801053'] = ['000975', '002155', '002237', '600311', '600385', '600489', '600547', '600687', '600766',
                              '600988', '601069', '601899']
        stockMap['801054'] = ['000657', '000831', '000960', '002149', '002167', '002378', '002428', '002460', '002466',
                              '002716', '002738', '002842', '300618', '600111', '600259', '600392', '600456', '600459',
                              '600549', '600711', '601958', '603399', '603663', '603799', '603993']
        stockMap['801055'] = ['000060', '000426', '000603', '000612', '000630', '000688', '000751', '000758', '000807',
                              '000878', '000933', '002114', '002160', '002171', '002203', '002295', '002379', '002501',
                              '002540', '002578', '002806', '002824', '002988', '002996', '300328', '300337', '300697',
                              '300828', '600219', '600255', '600331', '600338', '600362', '600490', '600497', '600531',
                              '600595', '600768', '600888', '600961', '601020', '601137', '601168', '601212', '601388',
                              '601600', '601609', '601677', '601702', '603003', '603115', '603527', '603876', '688388']
        stockMap['801072'] = ['000410', '000530', '000570', '000595', '000777', '000811', '000816', '000837', '000880',
                              '002026', '002046', '002122', '002158', '002164', '002248', '002272', '002282', '002347',
                              '002426', '002438', '002444', '002480', '002514', '002520', '002532', '002552', '002559',
                              '002598', '002633', '002639', '002685', '002686', '002747', '002760', '002795', '002871',
                              '002877', '002884', '002896', '002903', '002931', '002943', '300024', '300064', '300080',
                              '300091', '300092', '300095', '300126', '300145', '300154', '300161', '300179', '300193',
                              '300222', '300257', '300260', '300278', '300345', '300391', '300400', '300420', '300421',
                              '300430', '300441', '300464', '300470', '300488', '300503', '300554', '300606', '300607',
                              '300629', '300700', '300718', '300780', '300809', '300817', '300818', '300838', '300853',
                              '300861', '600172', '600218', '600243', '600421', '600481', '600592', '600841', '601002',
                              '601100', '601177', '601369', '601882', '603088', '603090', '603131', '603187', '603269',
                              '603277', '603308', '603315', '603331', '603339', '603486', '603617', '603666', '603667',
                              '603699', '603757', '603915', '603985', '605100', '688003', '688017', '688028', '688090',
                              '688165', '688169', '688218', '688333', '688360', '688516', '688518', '688558', '688577']
        stockMap['801073'] = ['000901', '002338', '002819', '002849', '002857', '002870', '002980', '300007', '300066',
                              '300112', '300114', '300165', '300259', '300306', '300341', '300349', '300354', '300370',
                              '300371', '300410', '300416', '300417', '300445', '300515', '300553', '300557', '300567',
                              '300572', '300648', '300667', '300720', '603556', '603662', '603700', '688056', '688528']
        stockMap['801074'] = ['000157', '000425', '000528', '000551', '000584', '000680', '000821', '000852', '000856',
                              '002006', '002009', '002021', '002031', '002073', '002097', '002111', '002192', '002204',
                              '002209', '002278', '002337', '002353', '002366', '002367', '002430', '002483', '002490',
                              '002523', '002526', '002529', '002535', '002564', '002595', '002611', '002613', '002645',
                              '002651', '002667', '002689', '002690', '002691', '002698', '002722', '002730', '002757',
                              '002774', '002779', '002786', '002796', '002816', '002833', '002837', '002890', '002957',
                              '002960', '002975', '300004', '300084', '300097', '300099', '300103', '300151', '300171',
                              '300173', '300195', '300201', '300210', '300275', '300276', '300281', '300293', '300307',
                              '300382', '300385', '300411', '300412', '300415', '300442', '300450', '300457', '300461',
                              '300471', '300472', '300480', '300483', '300486', '300499', '300509', '300512', '300521',
                              '300540', '300549', '300551', '300604', '300619', '300669', '300724', '300751', '300756',
                              '300757', '300776', '300786', '300800', '300802', '300812', '300813', '300823', '300833',
                              '300836', '300837', '300862', '300865', '300879', '600031', '600169', '600262', '600302',
                              '600320', '600375', '600388', '600444', '600499', '600501', '600520', '600526', '600545',
                              '600560', '600579', '600582', '600761', '600815', '600835', '600843', '600894', '600984',
                              '601038', '601106', '601399', '601608', '601798', '603011', '603012', '603029', '603036',
                              '603076', '603095', '603159', '603169', '603185', '603203', '603279', '603283', '603289',
                              '603298', '603311', '603318', '603321', '603337', '603338', '603356', '603488', '603611',
                              '603638', '603656', '603686', '603690', '603789', '603800', '603855', '603895', '603901',
                              '603912', '603956', '603960', '603966', '688001', '688006', '688012', '688022', '688037',
                              '688090', '688128', '688155', '688200', '688215', '688277', '688309', '688310', '688312',
                              '688377', '688378', '688518', '688551', '688556', '688559', '688596', '688600']
        stockMap['801075'] = ['000039', '002132', '002150', '002342', '002487', '002843', '002965', '300228', '300402',
                              '300885', '600558', '600860', '600992', '601028', '603028', '603278', '603626', '603969',
                              '688379']
        stockMap['801076'] = ['000008', '000925', '000976', '002972', '300351', '300594', '300851', '600495', '600528',
                              '601766', '603111', '603500', '603680', '605001', '688009', '688015', '688033', '688569']
        stockMap['801081'] = ['002049', '002077', '002079', '002119', '002156', '002185', '002371', '002409', '300046',
                              '300053', '300077', '300139', '300223', '300327', '300346', '300373', '300456', '300458',
                              '300493', '300613', '300623', '300661', '300666', '300671', '300672', '300706', '300782',
                              '300831', '300842', '600171', '600198', '600360', '600460', '600584', '600667', '603005',
                              '603068', '603160', '603290', '603501', '603893', '603933', '603986', '688002', '688008',
                              '688018', '688019', '688037', '688099', '688123', '688126', '688138', '688200', '688233',
                              '688256', '688286', '688368', '688396', '688508', '688521', '688589', '688595', '688981']
        stockMap['801082'] = ['000062', '000988', '002008', '002141', '002161', '002214', '002388', '002414', '002724',
                              '002729', '002869', '300184', '300220', '300340', '300390', '300438', '300516', '300656',
                              '300736', '300747', '300866', '300868', '600071', '600110', '600152', '600288', '600353',
                              '600751', '600884', '603595', '603931', '688020', '688025', '688093', '688360', '688528']
        stockMap['801083'] = ['000532', '000636', '000701', '000733', '000823', '002134', '002138', '002199', '002222',
                              '002288', '002384', '002436', '002463', '002484', '002579', '002618', '002636', '002815',
                              '002913', '002916', '002938', '300408', '300460', '300476', '300657', '300726', '300739',
                              '300852', '600183', '600237', '600563', '600601', '603186', '603228', '603267', '603328',
                              '603386', '603678', '603738', '603920', '603936', '603989', '688138', '688519']
        stockMap['801084'] = ['000045', '000050', '000100', '000413', '000536', '000541', '000725', '000727', '002005',
                              '002036', '002076', '002106', '002189', '002217', '002273', '002289', '002387', '002449',
                              '002456', '002587', '002745', '002808', '002841', '002845', '002876', '002952', '002955',
                              '002962', '002983', '002992', '300032', '300076', '300088', '300102', '300120', '300128',
                              '300162', '300219', '300232', '300241', '300296', '300301', '300303', '300319', '300323',
                              '300331', '300389', '300545', '300566', '300582', '300625', '300632', '300650', '300691',
                              '300701', '300708', '300752', '300790', '300808', '600261', '600363', '600552', '600651',
                              '600666', '600703', '600707', '603297', '603303', '603515', '603679', '603685', '603773',
                              '605118', '688007', '688010', '688055', '688181', '688299']
        stockMap['801085'] = ['000020', '000021', '000049', '002045', '002055', '002139', '002236', '002241', '002351',
                              '002369', '002402', '002415', '002475', '002547', '002600', '002635', '002655', '002660',
                              '002681', '002782', '002850', '002855', '002859', '002861', '002866', '002881', '002885',
                              '002888', '002922', '002925', '002937', '002947', '002970', '002976', '002981', '002993',
                              '300083', '300115', '300131', '300136', '300207', '300227', '300256', '300279', '300322',
                              '300433', '300543', '300602', '300647', '300679', '300684', '300686', '300709', '300735',
                              '300787', '300793', '300822', '300843', '300857', '600203', '600478', '600745', '601138',
                              '601231', '603327', '603380', '603629', '603633', '603890', '688036']
        stockMap['801092'] = ['000025', '000753', '000996', '300825', '600297', '600327', '600335', '600653', '601258',
                              '601965', '603377']
        stockMap['801093'] = ['000030', '000338', '000559', '000581', '000622', '000678', '000700', '000757', '000887',
                              '000903', '000980', '001696', '002048', '002085', '002101', '002126', '002213', '002239',
                              '002265', '002283', '002284', '002328', '002355', '002363', '002406', '002434', '002448',
                              '002454', '002472', '002488', '002510', '002516', '002536', '002553', '002590', '002592',
                              '002625', '002662', '002684', '002703', '002708', '002715', '002725', '002765', '002813',
                              '002863', '002865', '002906', '002921', '002997', '300100', '300258', '300304', '300375',
                              '300428', '300432', '300473', '300507', '300547', '300580', '300585', '300611', '300643',
                              '300652', '300680', '300681', '300694', '300695', '300707', '300733', '300742', '300816',
                              '300863', '600081', '600148', '600178', '600480', '600523', '600609', '600626', '600660',
                              '600676', '600698', '600699', '600741', '600742', '600933', '600960', '601311', '601689',
                              '601717', '601799', '603006', '603009', '603013', '603023', '603035', '603037', '603040',
                              '603085', '603089', '603109', '603121', '603158', '603161', '603166', '603178', '603179',
                              '603197', '603239', '603286', '603305', '603306', '603319', '603335', '603348', '603358',
                              '603390', '603586', '603596', '603655', '603701', '603730', '603758', '603767', '603768',
                              '603786', '603788', '603809', '603917', '603922', '603926', '603950', '603982', '603997',
                              '605088', '605255', '605333']
        stockMap['801094'] = ['000550', '000572', '000625', '000800', '000868', '000927', '000951', '000957', '002594',
                              '600006', '600066', '600104', '600166', '600213', '600303', '600418', '600686', '600733',
                              '601127', '601238', '601633', '601777']
        stockMap['801101'] = ['000066', '000977', '000997', '002152', '002177', '002180', '002197', '002268', '002296',
                              '002308', '002376', '002383', '002512', '002528', '002577', '002835', '002912', '002990',
                              '300042', '300045', '300130', '300155', '300177', '300202', '300270', '300302', '300333',
                              '300368', '300386', '300449', '300455', '300462', '300479', '300546', '300771', '300789',
                              '300807', '300845', '600100', '600800', '600855', '603019', '603106', '603496', '603516',
                              '603660', '688027', '688060', '688086', '688208', '688288']
        stockMap['801102'] = ['000032', '000063', '000070', '000586', '000836', '000851', '000971', '002017', '002089',
                              '002093', '002104', '002115', '002194', '002231', '002281', '002313', '002396', '002446',
                              '002491', '002544', '002583', '002792', '002897', '002902', '002908', '002929', '300017',
                              '300025', '300050', '300081', '300098', '300134', '300183', '300205', '300211', '300213',
                              '300252', '300308', '300310', '300312', '300353', '300383', '300394', '300414', '300502',
                              '300504', '300513', '300531', '300548', '300555', '300560', '300563', '300565', '300570',
                              '300571', '300590', '300597', '300603', '300615', '300620', '300627', '300628', '300638',
                              '300689', '300698', '300710', '300711', '600105', '600130', '600260', '600289', '600293',
                              '600345', '600355', '600462', '600487', '600498', '600522', '600734', '600775', '600776',
                              '600804', '601869', '603042', '603083', '603118', '603220', '603236', '603322', '603421',
                              '603559', '603602', '603703', '603712', '603803', '688027', '688036', '688058', '688080',
                              '688100', '688118', '688159', '688313', '688418']
        stockMap['801111'] = ['000333', '000404', '000521', '000651', '000921', '002011', '002032', '002035', '002050',
                              '002242', '002290', '002403', '002418', '002473', '002508', '002543', '002614', '002668',
                              '002676', '002677', '002705', '002723', '002759', '002860', '002959', '300160', '300217',
                              '300247', '300249', '300272', '300342', '300403', '300475', '300824', '600336', '600619',
                              '600690', '600854', '600983', '603355', '603366', '603519', '603551', '603578', '603579',
                              '603657', '603677', '603726', '603868']
        stockMap['801112'] = ['000016', '000801', '000810', '002052', '002420', '002429', '002519', '002848', '600060',
                              '600839', '603996']
        stockMap['801123'] = ['000568', '000596', '000729', '000752', '000799', '000848', '000858', '000860', '000869',
                              '000929', '002304', '002461', '002568', '002646', '600059', '600084', '600132', '600189',
                              '600197', '600199', '600238', '600300', '600365', '600519', '600543', '600559', '600573',
                              '600600', '600616', '600702', '600779', '600809', '601579', '603156', '603198', '603369',
                              '603589', '603711', '603779', '603919', '605388']
        stockMap['801124'] = ['000639', '000716', '000895', '002216', '002329', '002330', '002481', '002495', '002507',
                              '002515', '002557', '002570', '002582', '002650', '002661', '002695', '002702', '002719',
                              '002726', '002732', '002770', '002820', '002840', '002847', '002910', '002946', '002956',
                              '002991', '300146', '300741', '300783', '300791', '300858', '600073', '600186', '600305',
                              '600419', '600429', '600597', '600866', '600872', '600882', '600887', '603020', '603027',
                              '603043', '603288', '603317', '603345', '603517', '603536', '603696', '603697', '603719',
                              '603755', '603777', '603866', '603886', '688089']
        stockMap['801131'] = ['000611', '000726', '000850', '000955', '000982', '002003', '002042', '002083', '002087',
                              '002098', '002144', '002193', '002394', '002404', '002674', '300577', '300658', '300819',
                              '300877', '600156', '600220', '600232', '600370', '600448', '600493', '600689', '600987',
                              '601339', '603055', '603238', '603477', '603889']
        stockMap['801132'] = ['002029', '002154', '002269', '002291', '002293', '002327', '002397', '002485', '002486',
                              '002494', '002503', '002563', '002569', '002612', '002634', '002656', '002687', '002762',
                              '002763', '002776', '002780', '002832', '002875', '300005', '300526', '300591', '300840',
                              '600107', '600137', '600146', '600398', '600400', '600630', '600824', '601566', '601718',
                              '603001', '603116', '603157', '603196', '603365', '603518', '603555', '603557', '603558',
                              '603587', '603608', '603665', '603808', '603839', '603877', '603908', '603958', '605003']
        stockMap['801141'] = ['000659', '000695', '000812', '002014', '002117', '002191', '002228', '002229', '002243',
                              '002303', '002522', '002565', '002585', '002599', '002701', '002735', '002752', '002787',
                              '002799', '002803', '002831', '002836', '002846', '002951', '002969', '300057', '300501',
                              '300849', '300883', '600076', '600210', '600836', '601515', '601968', '603022', '603058',
                              '603429', '603499', '603607', '603687']
        stockMap['801142'] = ['000026', '000587', '000663', '000910', '002084', '002240', '002301', '002345', '002348',
                              '002356', '002489', '002571', '002572', '002574', '002575', '002605', '002615', '002631',
                              '002678', '002721', '002731', '002740', '002790', '002798', '002853', '002862', '002867',
                              '002899', '300329', '300616', '300640', '300651', '300703', '300729', '300749', '600086',
                              '600135', '600337', '600439', '600539', '600612', '600735', '600978', '601996', '603008',
                              '603021', '603059', '603180', '603195', '603208', '603221', '603226', '603268', '603313',
                              '603326', '603385', '603389', '603398', '603408', '603600', '603610', '603661', '603709',
                              '603801', '603816', '603818', '603833', '603838', '603848', '603898', '603899', '603992']
        stockMap['801143'] = ['000488', '000815', '002012', '002067', '002078', '002235', '002511', '002521', '600103',
                              '600235', '600308', '600356', '600433', '600567', '600793', '600963', '600966', '603165',
                              '603733', '603863']
        stockMap['801151'] = ['000004', '000153', '000513', '000566', '000597', '000623', '000739', '000756', '000766',
                              '000788', '000813', '000908', '000915', '000931', '000952', '000963', '002001', '002019',
                              '002020', '002099', '002102', '002262', '002294', '002332', '002365', '002370', '002393',
                              '002399', '002411', '002422', '002435', '002437', '002550', '002626', '002653', '002675',
                              '002755', '002773', '002793', '002821', '002898', '002900', '002923', '002940', '300006',
                              '300016', '300086', '300110', '300158', '300194', '300199', '300233', '300254', '300267',
                              '300363', '300401', '300434', '300436', '300452', '300497', '300558', '300573', '300583',
                              '300584', '300630', '300636', '300702', '300705', '300723', '300725', '300765', '600062',
                              '600079', '600200', '600216', '600227', '600267', '600276', '600380', '600420', '600488',
                              '600513', '600521', '600613', '600664', '600673', '600781', '600789', '600812', '600851',
                              '603079', '603168', '603222', '603229', '603351', '603456', '603520', '603538', '603669',
                              '603676', '603707', '603811', '688089', '688166', '688189', '688266', '688321', '688356',
                              '688505', '688513', '688566']
        stockMap['801152'] = ['000403', '000504', '000518', '000534', '000661', '002007', '002038', '002166', '002252',
                              '002581', '002693', '002880', '300009', '300122', '300142', '300204', '300239', '300255',
                              '300294', '300357', '300381', '300485', '300601', '300683', '300841', '600080', '600161',
                              '600196', '600530', '600645', '600682', '600739', '600796', '600867', '603087', '603590',
                              '688026', '688166', '688177', '688180', '688185', '688266', '688278', '688336', '688363',
                              '688366', '688488', '688520']
        stockMap['801153'] = ['000710', '002022', '002030', '002223', '002382', '002432', '002551', '002901', '002932',
                              '002950', '300003', '300030', '300049', '300206', '300238', '300244', '300246', '300273',
                              '300289', '300298', '300314', '300318', '300326', '300358', '300396', '300406', '300439',
                              '300453', '300463', '300482', '300529', '300562', '300595', '300633', '300639', '300642',
                              '300653', '300676', '300677', '300685', '300753', '300760', '300832', '300869', '600055',
                              '600529', '600587', '603301', '603309', '603367', '603387', '603392', '603658', '603880',
                              '603976', '603987', '688013', '688016', '688029', '688050', '688068', '688085', '688108',
                              '688139', '688198', '688277', '688289', '688298', '688301', '688310', '688338', '688358',
                              '688366', '688389', '688393', '688399', '688580']
        stockMap['801154'] = ['000028', '000078', '000411', '000705', '000950', '002462', '002589', '002727', '002758',
                              '002788', '002872', '600056', '600090', '600272', '600511', '600713', '600829', '600833',
                              '600998', '601607', '603233', '603368', '603716', '603883', '603939']
        stockMap['801155'] = ['000423', '000538', '000590', '000650', '000790', '000919', '000989', '000999', '002107',
                              '002118', '002198', '002275', '002287', '002317', '002349', '002390', '002412', '002424',
                              '002433', '002566', '002603', '002644', '002728', '002737', '002750', '002817', '002826',
                              '002864', '002873', '002907', '300026', '300039', '300108', '300147', '300181', '300519',
                              '300534', '300878', '600085', '600129', '600211', '600222', '600252', '600285', '600329',
                              '600332', '600351', '600422', '600436', '600479', '600518', '600535', '600538', '600557',
                              '600566', '600572', '600594', '600671', '600750', '600771', '600976', '600993', '603139',
                              '603439', '603567', '603858', '603896', '603963', '603998', '605199']
        stockMap['801156'] = ['000150', '000503', '000509', '000516', '002044', '002173', '002219', '002524', '300015',
                              '300143', '300149', '300347', '300404', '300759', '600721', '600763', '600767', '600896',
                              '603108', '603127', '603259', '603882', '688202', '688222']
        stockMap['801161'] = ['000027', '000037', '000040', '000155', '000531', '000539', '000543', '000591', '000600',
                              '000601', '000690', '000692', '000720', '000722', '000767', '000791', '000862', '000875',
                              '000883', '000899', '000958', '000966', '000993', '001896', '002015', '002039', '002256',
                              '002499', '002608', '002610', '002616', '002893', '003816', '300125', '600011', '600021',
                              '600023', '600025', '600027', '600098', '600101', '600116', '600131', '600163', '600167',
                              '600236', '600310', '600396', '600452', '600483', '600505', '600509', '600578', '600642',
                              '600644', '600674', '600719', '600726', '600744', '600780', '600795', '600863', '600868',
                              '600886', '600900', '600969', '600979', '600982', '600995', '601016', '601619', '601778',
                              '601985', '601991', '603693']
        stockMap['801163'] = ['000407', '000421', '000593', '000669', '002259', '002267', '002700', '002911', '300435',
                              '600333', '600617', '600635', '600681', '600803', '600856', '600903', '600917', '600956',
                              '601139', '603053', '603080', '603393', '603689', '603706']
        stockMap['801164'] = ['000544', '000598', '000605', '000685', '300388', '300664', '300692', '600008', '600168',
                              '600187', '600283', '600461', '600874', '601158', '601199', '601368', '603797', '603817',
                              '603903']
        stockMap['801171'] = ['000088', '000507', '000582', '000905', '001872', '002040', '600017', '600018', '600190',
                              '600279', '600317', '600717', '601000', '601008', '601018', '601228', '601298', '601326',
                              '601880']
        stockMap['801172'] = ['002357', '002627', '600561', '600611', '600650', '600662', '600834', '603032', '603069']
        stockMap['801173'] = ['000099', '002928', '600029', '600115', '600221', '601021', '601111', '603885']
        stockMap['801174'] = ['000089', '600004', '600009', '600897']
        stockMap['801175'] = ['000429', '000548', '000755', '000828', '000885', '000886', '000900', '001965', '600012',
                              '600020', '600033', '600035', '600106', '600269', '600350', '600368', '600377', '600548',
                              '601107', '601188', '601518']
        stockMap['801176'] = ['000520', '002320', '600026', '600428', '600798', '601866', '601872', '601919', '601975',
                              '603167']
        stockMap['801177'] = ['000557', '600125', '601006', '601333', '601816']
        stockMap['801178'] = ['002010', '002120', '002183', '002210', '002245', '002352', '002468', '002492', '002682',
                              '002769', '002800', '002889', '002930', '300013', '300240', '300350', '300873', '600057',
                              '600119', '600153', '600179', '600180', '600233', '600575', '600704', '600787', '600794',
                              '601598', '603056', '603066', '603117', '603128', '603223', '603329', '603535', '603569',
                              '603648', '603713', '603813', '603871', '603967']
        stockMap['801181'] = ['000002', '000006', '000011', '000014', '000029', '000031', '000036', '000042', '000046',
                              '000056', '000069', '000090', '000402', '000502', '000506', '000514', '000517', '000537',
                              '000540', '000558', '000560', '000573', '000608', '000609', '000615', '000616', '000620',
                              '000631', '000656', '000667', '000668', '000671', '000679', '000691', '000718', '000732',
                              '000736', '000797', '000809', '000838', '000863', '000897', '000909', '000918', '000926',
                              '000961', '000965', '000981', '001914', '001979', '002016', '002133', '002146', '002147',
                              '002208', '002244', '002285', '002305', '002314', '002377', '002968', '600007', '600048',
                              '600067', '600077', '600094', '600159', '600162', '600173', '600177', '600185', '600208',
                              '600223', '600225', '600239', '600246', '600266', '600322', '600325', '600340', '600376',
                              '600383', '600393', '600466', '600503', '600510', '600515', '600533', '600565', '600568',
                              '600606', '600622', '600638', '600641', '600647', '600649', '600657', '600665', '600675',
                              '600683', '600684', '600692', '600708', '600716', '600724', '600732', '600736', '600743',
                              '600748', '600773', '600791', '600807', '600823', '600890', '601155', '601588', '603506']
        stockMap['801182'] = ['600064', '600082', '600215', '600463', '600604', '600639', '600648', '600658', '600663',
                              '600848', '600895', '601512']
        stockMap['801191'] = ['000415', '000416', '000563', '000567', '000617', '000666', '000890', '002423', '002647',
                              '002961', '300023', '300176', '300309', '600053', '600093', '600120', '600318', '600390',
                              '600599', '600643', '600695', '600696', '600705', '600783', '600816', '600830', '600901',
                              '603093', '603300']
        stockMap['801192'] = ['000001', '002142', '002807', '002839', '002936', '002948', '002958', '002966', '600000',
                              '600015', '600016', '600036', '600908', '600919', '600926', '600928', '601009', '601077',
                              '601128', '601166', '601169', '601229', '601288', '601328', '601398', '601577', '601658',
                              '601818', '601838', '601860', '601916', '601939', '601988', '601997', '601998', '603323']
        stockMap['801193'] = ['000166', '000686', '000712', '000728', '000750', '000776', '000783', '000987', '002500',
                              '002670', '002673', '002736', '002797', '002926', '002939', '002945', '300059', '600030',
                              '600061', '600095', '600109', '600155', '600369', '600621', '600837', '600864', '600909',
                              '600918', '600958', '600999', '601066', '601099', '601108', '601162', '601198', '601211',
                              '601236', '601375', '601377', '601456', '601555', '601688', '601696', '601788', '601878',
                              '601881', '601901', '601990']
        stockMap['801194'] = ['000627', '600291', '601318', '601319', '601336', '601601', '601628']
        stockMap['801202'] = ['000019', '000151', '000626', '000906', '002091', '002505', '600058', '600145', '600247',
                              '600250', '600278', '600287', '600301', '600605', '600608', '600710', '600753', '600755',
                              '600822', '600826', '600870', '600981']
        stockMap['801203'] = ['000417', '000419', '000501', '000564', '000715', '000759', '000785', '002187', '002251',
                              '002264', '002277', '002336', '002419', '002561', '002640', '002697', '600280', '600306',
                              '600361', '600628', '600693', '600694', '600697', '600712', '600723', '600729', '600774',
                              '600778', '600785', '600814', '600821', '600827', '600828', '600838', '600857', '600858',
                              '600859', '600861', '600865', '601010', '601086', '601113', '601116', '601366', '601933',
                              '603031', '603101', '603123', '603708', '605188']
        stockMap['801204'] = ['000829', '002024', '002127', '002416', '300022', '300622', '300755', '600122', '600655',
                              '600898', '603214', '603900']
        stockMap['801205'] = ['000007', '000058', '000061', '000861', '000882', '002344', '002818', '600113', '600415',
                              '600738', '600790', '601828', '603682']
        stockMap['801211'] = ['000721', '002186', '002306', '605108']
        stockMap['801212'] = ['000430', '000888', '000978', '300144', '300859', '600054', '600593', '600749', '603099',
                              '603136', '603199']
        stockMap['801213'] = ['000428', '000610', '000613', '600258', '600754', '601007']
        stockMap['801214'] = ['000524', '000796', '002033', '002059', '002159', '002707', '300178', '600138', '600358',
                              '600555', '600706', '601888']
        stockMap['801222'] = ['000034', '000158', '000555', '000606', '000662', '000938', '000948', '002063', '002065',
                              '002072', '002153', '002195', '002212', '002230', '002232', '002253', '002279', '002280',
                              '002312', '002316', '002331', '002362', '002368', '002373', '002380', '002401', '002405',
                              '002410', '002417', '002421', '002439', '002474', '002530', '002537', '002609', '002642',
                              '002649', '002657', '002766', '002771', '002777', '002920', '002987', '300002', '300010',
                              '300020', '300033', '300036', '300044', '300047', '300074', '300075', '300078', '300079',
                              '300085', '300096', '300150', '300166', '300167', '300168', '300170', '300188', '300209',
                              '300212', '300229', '300231', '300235', '300245', '300248', '300250', '300253', '300264',
                              '300271', '300277', '300287', '300288', '300290', '300297', '300300', '300311', '300324',
                              '300330', '300339', '300344', '300348', '300352', '300365', '300366', '300367', '300369',
                              '300377', '300378', '300379', '300380', '300399', '300419', '300440', '300448', '300451',
                              '300454', '300465', '300468', '300469', '300496', '300508', '300520', '300523', '300525',
                              '300532', '300541', '300542', '300550', '300552', '300556', '300559', '300561', '300579',
                              '300588', '300598', '300605', '300608', '300609', '300624', '300634', '300645', '300659',
                              '300663', '300674', '300678', '300682', '300687', '300730', '300738', '300766', '300768',
                              '300773', '300799', '300803', '300830', '300846', '300872', '600271', '600410', '600446',
                              '600476', '600536', '600570', '600571', '600588', '600602', '600654', '600718', '600728',
                              '600756', '600797', '600845', '600850', '601360', '601519', '603039', '603138', '603189',
                              '603232', '603383', '603508', '603528', '603636', '603869', '603881', '603918', '603927',
                              '603990', '688004', '688023', '688030', '688039', '688051', '688058', '688066', '688078',
                              '688081', '688086', '688088', '688095', '688111', '688118', '688158', '688168', '688188',
                              '688228', '688229', '688258', '688288', '688318', '688365', '688369', '688500', '688555',
                              '688561', '688568', '688579', '688588']
        stockMap['801223'] = ['000889', '002467', '300578', '600050']
        stockMap['801231'] = ['000009', '000409', '000632', '000638', '000652', '000839', '002967', '300012', '300688',
                              '300797', '600051', '600070', '600083', '600128', '600139', '600149', '600212', '600234',
                              '600281', '600382', '600603', '600620', '600624', '600730', '600770', '600784', '600805',
                              '600811', '600817', '600818', '603060', '603183']
        stockMap['801711'] = ['000401', '000546', '000672', '000789', '000877', '000935', '002233', '600326', '600425',
                              '600449', '600585', '600668', '600720', '600801', '600802', '600881', '600883', '601992']
        stockMap['801712'] = ['000012', '002623', '300093', '600586', '600819', '600876', '601636', '601865']
        stockMap['801713'] = ['000023', '000619', '000786', '002043', '002066', '002082', '002088', '002162', '002163',
                              '002225', '002271', '002302', '002323', '002333', '002372', '002392', '002398', '002457',
                              '002596', '002641', '002652', '002671', '002694', '002718', '002742', '002785', '002791',
                              '002918', '300117', '300198', '300234', '300374', '300599', '300715', '300737', '600321',
                              '600678', '603038', '603616', '603856', '603937', '605158', '605318', '688398']
        stockMap['801721'] = ['000628', '002761', '002949', '300492', '300500', '300564', '300668', '300675', '300746',
                              '300778', '600170', '600491', '600629', '600769', '600846', '600939', '601668', '601789',
                              '603017', '603887']
        stockMap['801722'] = ['002047', '002081', '002325', '002375', '002482', '002504', '002620', '002713', '002781',
                              '002789', '002811', '002822', '002830', '002856', '002963', '002989', '300506', '300592',
                              '300621', '600193', '600209', '601886', '603030', '603081', '603466', '603828', '605178']
        stockMap['801723'] = ['000498', '000779', '002060', '002061', '002062', '002116', '002307', '002586', '002628',
                              '002883', '002941', '300284', '300712', '300732', '600039', '600068', '600133', '600284',
                              '600502', '600512', '600820', '600853', '601186', '601390', '601611', '601669', '601800',
                              '603018', '603357', '603458', '603815', '603843', '603860', '603909']
        stockMap['801724'] = ['000055', '000065', '000928', '002051', '002135', '002140', '002178', '002298', '002469',
                              '002541', '002542', '002593', '002743', '300384', '300517', '300635', '300826', '600248',
                              '600477', '600496', '600970', '601068', '601117', '601226', '601618', '603098', '603637',
                              '603698', '603929', '603959']
        stockMap['801725'] = ['000010', '002200', '002310', '002374', '002431', '002663', '002717', '002775', '300197',
                              '300237', '300355', '300495', '300536', '300649', '600610', '603007', '603316', '603359',
                              '603388', '603717', '603778', '603955']
        stockMap['801731'] = ['000922', '002176', '002196', '002249', '002576', '002801', '002823', '002892', '300626',
                              '300660', '600580', '603320', '603489', '603728', '603819', '603988']
        stockMap['801732'] = ['000400', '000682', '002058', '002090', '002121', '002169', '002184', '002322', '002334',
                              '002339', '002527', '002546', '002767', '002979', '300018', '300040', '300048', '300124',
                              '300208', '300286', '300356', '300360', '300407', '300427', '300466', '300484', '300490',
                              '300514', '300745', '300880', '300882', '600268', '600406', '600525', '600590', '601126',
                              '601222', '601567', '603015', '603025', '603050', '603063', '603100', '603416', '603583',
                              '603859', '605288', '688100', '688330']
        stockMap['801733'] = ['000803', '002074', '002129', '002202', '002218', '002227', '002255', '002309', '002335',
                              '002364', '002459', '002506', '002518', '002531', '002534', '002580', '002617', '002630',
                              '002665', '002733', '002851', '300011', '300014', '300029', '300068', '300105', '300111',
                              '300116', '300118', '300129', '300141', '300153', '300185', '300274', '300316', '300317',
                              '300376', '300393', '300443', '300491', '300569', '300593', '300693', '300713', '300750',
                              '300763', '300772', '300820', '300827', '300850', '300870', '600151', '600202', '600207',
                              '600241', '600290', '600405', '600416', '600438', '600475', '600537', '600847', '600875',
                              '601012', '601218', '601615', '601727', '601908', '603105', '603212', '603218', '603396',
                              '603507', '603628', '603659', '603806', '688186', '688339', '688390', '688408', '688516',
                              '688567', '688599']
        stockMap['801734'] = ['000533', '000585', '000806', '002028', '002112', '002270', '002276', '002300', '002346',
                              '002350', '002358', '002441', '002451', '002452', '002471', '002498', '002533', '002560',
                              '002606', '002622', '002692', '002706', '002879', '002882', '002927', '002953', '300001',
                              '300062', '300069', '300215', '300265', '300283', '300423', '300444', '300447', '300477',
                              '300510', '300617', '300670', '600089', '600112', '600192', '600312', '600379', '600468',
                              '600517', '600550', '600577', '600869', '600885', '600973', '601179', '601616', '601700',
                              '601877', '603016', '603333', '603530', '603577', '603606', '603618', '603829', '603861',
                              '603897', '605066', '605222']
        stockMap['801741'] = ['002025', '002151', '002829', '002935', '002977', '300034', '300101', '300123', '300474',
                              '300722', '600118', '600343', '600879', '601698']
        stockMap['801742'] = ['000561', '000687', '000697', '000738', '000768', '002013', '002023', '002179', '002190',
                              '002297', '002389', '002413', '002664', '002933', '002985', '300159', '300397', '300424',
                              '300581', '300696', '300719', '300775', '600038', '600316', '600372', '600391', '600760',
                              '600765', '600862', '600893', '605123', '688011', '688586']
        stockMap['801743'] = ['000519', '000547', '000576', '002465', '300527', '300762', '300875', '600184', '600435',
                              '600562', '600764', '600967', '600990', '601606', '688081', '688311']
        stockMap['801744'] = ['300008', '300065', '300589', '300600', '300810', '600072', '600150', '600482', '600685',
                              '601890', '601989']
        stockMap['801751'] = ['000038', '000607', '002027', '002071', '002131', '002137', '002400', '002591', '002654',
                              '002712', '002878', '002995', '300038', '300058', '300061', '300063', '300071', '300242',
                              '300269', '300280', '300336', '300343', '300392', '300612', '300781', '300792', '300805',
                              '600242', '600381', '600386', '600556', '600986', '603598', '603729', '603825', '605168']
        stockMap['801752'] = ['000526', '000676', '000681', '000835', '002095', '002103', '002113', '002123', '002148',
                              '002168', '002174', '002247', '002261', '002315', '002354', '002425', '002447', '002464',
                              '002502', '002517', '002555', '002558', '002602', '002619', '002624', '300031', '300043',
                              '300051', '300052', '300113', '300148', '300226', '300292', '300295', '300299', '300315',
                              '300359', '300413', '300418', '300459', '300467', '300494', '300518', '300533', '300770',
                              '300785', '600226', '600373', '600633', '600634', '600640', '600652', '600892', '603000',
                              '603258', '603444', '603533', '603613', '603888']
        stockMap['801761'] = ['000156', '000529', '000665', '000673', '000719', '000793', '000802', '000892', '000917',
                              '002175', '002181', '002188', '002238', '002292', '002343', '002445', '002607', '002621',
                              '002638', '002659', '002699', '002739', '002858', '002905', '300027', '300089', '300133',
                              '300182', '300192', '300251', '300282', '300291', '300338', '300364', '300426', '300528',
                              '300654', '300788', '600037', '600052', '600088', '600136', '600158', '600229', '600455',
                              '600551', '600576', '600636', '600637', '600661', '600715', '600757', '600825', '600831',
                              '600880', '600936', '600959', '600977', '600996', '601019', '601098', '601595', '601599',
                              '601801', '601811', '601858', '601900', '601928', '601929', '601949', '601999', '603096',
                              '603103', '603721', '603999']
        stockMap['801881'] = ['000017', '000913', '002105', '600099', '600679', '600877', '603129', '603766', '603776',
                              '603787']

    @abstractmethod
    def get_name(self):
        return SW2Driver.NAME

    def get_description(self):
        return SW2Driver.DESCRIPTION

    @abstractmethod
    def get_symbol_lists(self):
        return list(self.symbol_name_map.keys())

    @abstractmethod
    def get_symbol_name(self,symbol:str)->str:
        return self.symbol_name_map.get(symbol)

    @abstractmethod
    def support_interval(self,interval:Interval)->bool:
        return interval == Interval.DAILY or interval == Interval.MINUTE

    @abstractmethod
    def download_bars_from_net(self, context:Context, symbol:str, days:DayRange, storage: BarStorage):
        """
        只下载日行情。
        """
        download_cnt = 0
        day_list = days.items()
            # 不含数据，全量更新
        for day in day_list:
            bars =  self.download_day_and_mintue_bar_from_net(symbol,day)
            download_cnt += len(bars)
            storage.save_bar_data(bars)
                ###请求间隔时间为每隔5s中
            sleep(5)
        return download_cnt


    @abstractmethod
    def fetch_latest_bar(self,symbol_list:['str'])->Sequence["LatestBar"]:
        raise RuntimeError("暂不支持，待开发")

    def download_day_and_mintue_bar_from_net(self,code: str, day: datetime):
        """
        下载某个股票的某天的分钟行情和日行情
        """
        dt = day.strftime('%Y%m%d')
        url = f"http://139.196.211.109/sw_fs.action?username=raodongming&password=58edde63081e2ce001cf5800f68df36f&id={code}&date={dt}"
        print(f"url:{url}")
        res = requests.get(url=url)
        text = res.text
        """
        非交易日：text = 无结果。该品种不属于对应的市场或该品种在此时段没有交易。
        
        日期,昨收价 
        20201214,13739.150 
        时间,价格,成交量,成交额 
        09:30,13936.07,81225376,1426763400 
        09:31,13900.98,127141798,2151459600 
        09:32,13872.02,164886320,2758989400 
        09:33,13853.36,200413970,3339510200 
        """

        lines = text.splitlines(False)
        assert len(lines) >= 4
        tokens = lines[1].split(",")
        daytime_str = tokens[0]
        assert daytime_str == dt
        bars = []
        high_price = None
        low_price = None
        open_price = None
        close_price = None
        dayly_volume = None

        for i in range(3, len(lines)):
            tokens = lines[i].split(",")
            if (tokens is None or len(tokens) < 3):
                continue
            hour_mintue = tokens[0].split(":")
            hour = int(hour_mintue[0])
            minute = int(hour_mintue[1])

            price = float(tokens[1])
            volume = float(tokens[2])

            dayly_volume = volume
            close_price = price
            if open_price is None:
                open_price = price
            if high_price is None or high_price < price:
                high_price = price
            if low_price is None or low_price > price:
                low_price = price


            time = datetime(year=day.year, month=day.month, day=day.day, hour=hour, minute=minute, second=0)

            bar = BarData(
                symbol=code,
                _driver=self.get_name(),
                datetime=time,
                interval=Interval.MINUTE,
                volume=volume,
                open_price=price,
                high_price=price,
                low_price=price,
                close_price=price,
                open_interest=1.0,
            )
            bars.append(bar)
        day_time = datetime(year=day.year, month=day.month, day=day.day, hour=0, minute=0, second=0)
        dayly_bar = BarData(
            symbol=code,
            _driver=self.get_name(),
            datetime=day_time,
            interval=Interval.DAILY,
            volume=dayly_volume,
            open_price=open_price,
            high_price=high_price,
            low_price=low_price,
            close_price=close_price,
            open_interest=1.0,
        )
        bars.append(dayly_bar)
        return bars


if __name__ == "__main__":
    #url = f"http://139.196.211.109/sw_k.action?username=raodongming&password=58edde63081e2ce001cf5800f68df36f&id={code}&num={count}&datetime={dt}&period=d&srcIndex=1"

    drvier = SW2Driver()
    bars = drvier.download_day_and_mintue_bar_from_net('801744',datetime(2020,2,25))

    for _b in bars:
        print(f"__bar:{_b}")
